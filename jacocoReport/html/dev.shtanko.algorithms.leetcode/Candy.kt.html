<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Candy.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">kotlab</a> &gt; <a href="index.source.html" class="el_package">dev.shtanko.algorithms.leetcode</a> &gt; <span class="el_source">Candy.kt</span></div><h1>Candy.kt</h1><pre class="source lang-java linenums">/*
 * Copyright 2020 Oleksii Shtanko
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package dev.shtanko.algorithms.leetcode

import kotlin.math.max

/**
 * 135. Candy
 * @see &lt;a href=&quot;https://leetcode.com/problems/candy&quot;&gt;Source&lt;/a&gt;
 */
fun interface Candy {
    operator fun invoke(ratings: IntArray): Int
}

<span class="fc" id="L29">class CandyBruteForce : Candy {</span>
    override operator fun invoke(ratings: IntArray): Int {
<span class="fc bfc" id="L31" title="All 2 branches covered.">        val candies = IntArray(ratings.size) { 1 }</span>
<span class="fc" id="L32">        var flag = true</span>
<span class="fc" id="L33">        var sum = 0</span>
<span class="fc bfc" id="L34" title="All 2 branches covered.">        while (flag) {</span>
<span class="fc" id="L35">            flag = false</span>
<span class="fc bfc" id="L36" title="All 2 branches covered.">            for (i in ratings.indices) {</span>
<span class="fc bfc" id="L37" title="All 6 branches covered.">                if (i != ratings.size - 1 &amp;&amp; ratings[i] &gt; ratings[i + 1] &amp;&amp; candies[i] &lt;= candies[i + 1]) {</span>
<span class="fc" id="L38">                    candies[i] = candies[i + 1] + 1</span>
<span class="fc" id="L39">                    flag = true</span>
                }
<span class="fc bfc" id="L41" title="All 6 branches covered.">                if (i &gt; 0 &amp;&amp; ratings[i] &gt; ratings[i - 1] &amp;&amp; candies[i] &lt;= candies[i - 1]) {</span>
<span class="fc" id="L42">                    candies[i] = candies[i - 1] + 1</span>
<span class="fc" id="L43">                    flag = true</span>
                }
            }
        }
<span class="fc bfc" id="L47" title="All 2 branches covered.">        for (candy in candies) {</span>
<span class="fc" id="L48">            sum += candy</span>
        }
<span class="fc" id="L50">        return sum</span>
    }
}

<span class="fc" id="L54">class Candy2Arrays : Candy {</span>
    override operator fun invoke(ratings: IntArray): Int {
<span class="fc" id="L56">        var sum = 0</span>
<span class="fc bfc" id="L57" title="All 2 branches covered.">        val left2right = IntArray(ratings.size) { 1 }</span>
<span class="fc bfc" id="L58" title="All 2 branches covered.">        val right2left = IntArray(ratings.size) { 1 }</span>
<span class="fc bfc" id="L59" title="All 2 branches covered.">        for (i in 1 until ratings.size) {</span>
<span class="fc bfc" id="L60" title="All 2 branches covered.">            if (ratings[i] &gt; ratings[i - 1]) {</span>
<span class="fc" id="L61">                left2right[i] = left2right[i - 1] + 1</span>
            }
        }
<span class="fc bfc" id="L64" title="All 2 branches covered.">        for (i in ratings.size - 2 downTo 0) {</span>
<span class="fc bfc" id="L65" title="All 2 branches covered.">            if (ratings[i] &gt; ratings[i + 1]) {</span>
<span class="fc" id="L66">                right2left[i] = right2left[i + 1] + 1</span>
            }
        }
<span class="fc bfc" id="L69" title="All 2 branches covered.">        for (i in ratings.indices) {</span>
<span class="fc" id="L70">            sum += max(left2right[i], right2left[i])</span>
        }
<span class="fc" id="L72">        return sum</span>
    }
}

<span class="fc" id="L76">class CandyArray : Candy {</span>
    override operator fun invoke(ratings: IntArray): Int {
<span class="fc bfc" id="L78" title="All 4 branches covered.">        if (ratings.isEmpty()) return 0</span>
<span class="fc bfc" id="L79" title="All 2 branches covered.">        val candies = IntArray(ratings.size) { 1 }</span>
<span class="fc bfc" id="L80" title="All 2 branches covered.">        for (i in 1 until ratings.size) {</span>
<span class="fc bfc" id="L81" title="All 2 branches covered.">            if (ratings[i] &gt; ratings[i - 1]) {</span>
<span class="fc" id="L82">                candies[i] = candies[i - 1] + 1</span>
            }
        }
<span class="fc" id="L85">        var sum = candies[ratings.size - 1]</span>
<span class="fc bfc" id="L86" title="All 2 branches covered.">        for (i in ratings.size - 2 downTo 0) {</span>
<span class="fc bfc" id="L87" title="All 2 branches covered.">            if (ratings[i] &gt; ratings[i + 1]) {</span>
<span class="fc" id="L88">                candies[i] = max(candies[i], candies[i + 1] + 1)</span>
            }
<span class="fc" id="L90">            sum += candies[i]</span>
        }
<span class="fc" id="L92">        return sum</span>
    }
}

<span class="fc" id="L96">class CandyMath : Candy {</span>

    override operator fun invoke(ratings: IntArray): Int {
<span class="fc" id="L99">        fun count(n: Int) = n * n.plus(1) / 2</span>

<span class="fc bfc" id="L101" title="All 2 branches covered.">        if (ratings.size &lt;= 1) {</span>
<span class="fc" id="L102">            return ratings.size</span>
        }
<span class="fc" id="L104">        var candies = 0</span>
<span class="fc" id="L105">        var up = 0</span>
<span class="fc" id="L106">        var down = 0</span>
<span class="fc" id="L107">        var oldSlope = 0</span>
<span class="fc bfc" id="L108" title="All 2 branches covered.">        for (i in 1 until ratings.size) {</span>
<span class="fc bfc" id="L109" title="All 4 branches covered.">            val newSlope = if (ratings[i] &gt; ratings[i - 1]) 1 else if (ratings[i] &lt; ratings[i - 1]) -1 else 0</span>
<span class="fc bfc" id="L110" title="All 4 branches covered.">            val equalPredicate = oldSlope &gt; 0 &amp;&amp; newSlope == 0</span>
<span class="pc bpc" id="L111" title="1 of 4 branches missed.">            val greeterPredicate = oldSlope &lt; 0 &amp;&amp; newSlope &gt;= 0</span>

<span class="fc bfc" id="L113" title="All 4 branches covered.">            if (equalPredicate || greeterPredicate) {</span>
<span class="fc" id="L114">                candies += count(up) + count(down) + max(up, down)</span>
<span class="fc" id="L115">                up = 0</span>
<span class="fc" id="L116">                down = 0</span>
            }
<span class="fc bfc" id="L118" title="All 2 branches covered.">            if (newSlope &gt; 0) up++</span>
<span class="fc bfc" id="L119" title="All 2 branches covered.">            if (newSlope &lt; 0) down++</span>
<span class="fc bfc" id="L120" title="All 2 branches covered.">            if (newSlope == 0) candies++</span>
<span class="fc" id="L121">            oldSlope = newSlope</span>
        }
<span class="fc" id="L123">        candies += count(up) + count(down) + max(up, down) + 1</span>
<span class="fc" id="L124">        return candies</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>